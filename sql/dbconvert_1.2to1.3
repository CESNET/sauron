/* convert Sauron database format from 1.2 to 1.3 */
/* (this requires PostgreSQL v7.3 or later) */


/* vmps */
ALTER TABLE vmps DROP CONSTRAINT vmps_key;
ALTER TABLE vmps ADD CONSTRAINT vmps_key UNIQUE(name,server);
ALTER TABLE vmps ADD PRIMARY KEY(id);
DROP INDEX vmps_id_key;

/* vlans */
ALTER TABLE vlans DROP CONSTRAINT vlans_key;
ALTER TABLE vlans ADD CONSTRAINT vlans_key UNIQUE(name,server);
ALTER TABLE vlans ADD PRIMARY KEY(id);
DROP INDEX vlans_id_key;

/* nets */
ALTER TABLE nets DROP CONSTRAINT nets_key;
ALTER TABLE nets ADD CONSTRAINT nets_key UNIQUE(net,server);
ALTER TABLE nets ADD PRIMARY KEY(id);
DROP INDEX nets_id_key;

/* zones */
ALTER TABLE zones DROP CONSTRAINT zones_key;
ALTER TABLE zones ADD CONSTRAINT zones_key UNIQUE(name,server);
ALTER TABLE zones ADD PRIMARY KEY(id);
DROP INDEX zones_id_key;




/* UPDATE settings SET value='1.3' where setting='dbversion'; */

/* eof */

